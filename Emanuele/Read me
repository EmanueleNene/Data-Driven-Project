Here is modified code from marcus main framework
